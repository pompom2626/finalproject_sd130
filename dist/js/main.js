function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}!function(){var t={},r=[];function n(e){if(t[e])return t[e];var n=new Image;n.onload=function(){t[e]=n,a()&&r.forEach(function(e){e()})},t[e]=!1,n.src=e}function a(){var e=!0;for(var n in t)t.hasOwnProperty(n)&&!t[n]&&(e=!1);return e}window.Resources={load:function(e){e instanceof Array?e.forEach(function(e){n(e)}):n(e)},get:function(e){return t[e]},onReady:function(e){r.push(e)},isReady:a}}();var whoEnemy,randomSelectedEnemy,lives=3,levels=0,speed=2;function Sun(e,n){this.x=e,this.y=n}function Enemy(e,n,t,r,a){this.x=e,this.y=n,this.style=t,this.direction=r,this.speed=a}function randomRange(e,n){return Math.floor(Math.random()*(n-e+1)+e)}Enemy.prototype.update=function(e){this.x<800&&0<this.x&&"rtl"==this.direction?this.x+=1+this.speed:800<=this.x&&"rtl"==this.direction?(this.direction="ltr",this.x-=1+this.speed):0<this.x&&this.x<800&&(this.direction="ltr")?this.x-=1+this.speed:this.x<=0&&(this.direction="ltr")&&(this.direction="rtl",this.x+=1+this.speed),document.querySelector("#lives").lastChild.innerHTML=lives,document.querySelector("#score").lastChild.innerHTML=levels,this.hitcheckEnemy(player,allEnemies),this.hitcheckSun()},Enemy.prototype.hitcheckEnemy=function(n,e){e.forEach(function(e){return n.x<e.x+70&&n.x+70>e.x&&n.y<e.y+70&&80+n.y>e.y&&(--lives,n.x=300,n.y=400,lives<=0&&(alert("GAME END"),lives=3,allEnemies.forEach(function(e){e.speed=2}),speed=2,levels=0),!0)})},Enemy.prototype.hitcheckSun=function(){219<player.x&&player.x<381&&player.y<91&&(whoEnemy=parseInt(randomRange(0,2)),randomSelectedEnemy=allEnemies[whoEnemy],speed+=speed,randomSelectedEnemy.speed=speed,levels+=1,player.x=300,player.y=400)};var Player=function(){function t(e,n){_classCallCheck(this,t),this.x=e,this.y=n}return _createClass(t,[{key:"update",value:function(){}},{key:"handleInput",value:function(e){if("left"==e&&0<=this.x)this.x-=20;else if("up"==e){if(this.y<=0)return this.y=20;this.y-=20}else"right"==e&&-1<this.x&&this.x<=799?this.x+=20:"down"==e&&-1<this.y&&this.y<=439&&(this.y+=20)}}]),t}(),player=new Player(300,400),sun=new Sun(300,10),allEnemies=[new Enemy(200,80,"enemy1","rtl",2),new Enemy(100,150,"enemy2","rtl",2),new Enemy(300,250,"enemy3","rtl",2)];document.addEventListener("keyup",function(e){player.handleInput({37:"left",38:"up",39:"right",40:"down"}[e.keyCode])});var Engine=function(e){e.document;var n,t=e.window,r=document.getElementById("canvas"),a=r.getContext("2d");function i(){var e=Date.now();(function(n){allEnemies.forEach(function(e){e.update(n)}),player.update()})((e-n)/1e3),a.clearRect(0,0,r.width,r.height),a.drawImage(Resources.get("images/background.png"),0,0),function(){a.drawImage(Resources.get("images/sun.png"),sun.x,sun.y),player.tickCount++,player.tickCount>player.ticksPerFrame&&(player.tickCount=0,player.frameIndex++);player.frameIndex>=player.numberOfFrames&&(player.frameIndex=0);var e=Resources.get("images/player.png");a.drawImage(e,0,player.frameIndex*e.naturalHeight/player.numberOfFrames,e.naturalWidth,e.naturalHeight/player.numberOfFrames,player.x,player.y,e.naturalWidth,e.naturalHeight/player.numberOfFrames),allEnemies.forEach(function(e){e.tickCount++,e.tickCount>e.ticksPerFrame&&(e.tickCount=0,e.frameIndex++),e.frameIndex>=e.numberOfFrames&&(e.frameIndex=0);var n=Resources.get("images/".concat(e.style,"-").concat(e.direction,".png"));a.drawImage(n,0,e.frameIndex*n.naturalHeight/e.numberOfFrames,n.naturalWidth,n.naturalHeight/e.numberOfFrames,e.x,e.y,n.naturalWidth,n.naturalHeight/e.numberOfFrames)})}(),n=e,t.requestAnimationFrame(i)}r.width=900,r.height=534,Resources.load(["images/background.png","images/enemy1-ltr.png","images/enemy2-ltr.png","images/enemy3-ltr.png","images/enemy1-rtl.png","images/enemy2-rtl.png","images/enemy3-rtl.png","images/enemy4-rtl.png","images/enemy4-ltr.png","images/sun.png","images/player.png"]),Resources.onReady(function(){allEnemies.forEach(function(e){e.tickCount=0,e.ticksPerFrame=5,e.frameIndex=0,e.numberOfFrames=3}),player.tickCount=0,player.ticksPerFrame=5,player.frameIndex=0,player.numberOfFrames=2,n=Date.now(),i()}),e.ctx=a}(this);